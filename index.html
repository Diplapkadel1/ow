<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DiplapSite Whiteboard</title>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        :root {
            --bg: #121212;
            --panel: #1e1e1e;
            --accent: #00ff00;
            --text: #ececec;
            --border: #333;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; }
        body {
            background-color: var(--bg);
            color: var(--text);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            height: 100vh; width: 100vw; overflow: hidden;
        }

        /* Canvas */
        #canvas-container { position: absolute; inset: 0; z-index: 1; }
        canvas { display: block; cursor: crosshair; }

        /* Floating Toolbars (Excalidraw Style) */
        .ui-panel {
            position: fixed; z-index: 10; pointer-events: none;
            display: flex; gap: 10px;
        }
        .ui-panel > * { pointer-events: auto; }

        /* Top Left: Logo & Room */
        .top-left { top: 20px; left: 20px; flex-direction: column; }
        .card {
            background: var(--panel); border: 1px solid var(--border);
            padding: 8px 15px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.4);
        }
        .card h1 { font-size: 1rem; margin-bottom: 4px; }
        .card h1 span { color: var(--accent); }

        #btn-create {
            background: rgba(0, 255, 0, 0.1); border: 1px solid var(--accent);
            color: var(--accent); padding: 8px 12px; border-radius: 8px;
            cursor: pointer; font-weight: bold; transition: 0.2s;
            display: flex; align-items: center; gap: 6px;
        }
        #btn-create:hover { background: var(--accent); color: #000; }

        /* Center Toolbar */
        .main-tools {
            top: 20px; left: 50%; transform: translateX(-50%);
            background: var(--panel); border: 1px solid var(--border);
            padding: 5px; border-radius: 12px; display: flex; gap: 4px;
        }

        .tool-btn {
            background: transparent; border: none; color: var(--text);
            width: 40px; height: 40px; border-radius: 8px; cursor: pointer;
            display: flex; align-items: center; justify-content: center;
        }
        .tool-btn:hover { background: #2a2a2a; }
        .tool-btn.active { background: var(--accent); color: #000; }

        /* Bottom Controls (Zoom & Undo) */
        .bottom-right { bottom: 20px; right: 20px; }
        .bottom-left { bottom: 20px; left: 20px; }

        .control-group {
            background: var(--panel); border: 1px solid var(--border);
            padding: 5px; border-radius: 10px; display: flex; gap: 5px;
        }

        /* Modal */
        .modal {
            display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8);
            z-index: 100; align-items: center; justify-content: center;
        }
        .modal-box {
            background: var(--panel); padding: 20px; border-radius: 12px;
            border: 1px solid var(--accent); width: 90%; max-width: 400px;
        }
        textarea {
            width: 100%; height: 100px; background: #000; color: var(--accent);
            border: 1px solid var(--border); border-radius: 6px; padding: 10px; margin: 10px 0;
            font-family: monospace;
        }

        .room-info { font-size: 0.75rem; color: #888; margin-top: 5px; }

        @media (max-width: 600px) {
            .main-tools { bottom: 20px; top: auto; width: 90%; justify-content: space-around; }
            .top-left { width: calc(100% - 40px); }
        }
    </style>
</head>
<body>

    <div id="canvas-container">
        <canvas id="whiteboard"></canvas>
    </div>

    <!-- Top Left -->
    <div class="ui-panel top-left">
        <div class="card">
            <h1>DiplapSite <span>Whiteboard</span></h1>
            <div id="room-display" class="room-info" style="display:none">
                Room ID: <b id="room-id-text" style="color:var(--accent)"></b>
            </div>
        </div>
        <button id="btn-create"><i data-lucide="plus"></i> Create Room</button>
    </div>

    <!-- Center Toolbar -->
    <div class="ui-panel main-tools">
        <button class="tool-btn active" data-tool="pen" title="Pen"><i data-lucide="pencil"></i></button>
        <button class="tool-btn" data-tool="rect" title="Rectangle"><i data-lucide="square"></i></button>
        <button class="tool-btn" data-tool="ellipse" title="Ellipse"><i data-lucide="circle"></i></button>
        <button class="tool-btn" data-tool="line" title="Line"><i data-lucide="minus"></i></button>
        <button class="tool-btn" data-tool="arrow" title="Arrow"><i data-lucide="arrow-up-right"></i></button>
        <button class="tool-btn" data-tool="select" title="Selection (Drag)"><i data-lucide="mouse-pointer-2"></i></button>
        <button class="tool-btn" data-tool="text" title="Text"><i data-lucide="type"></i></button>
        <button class="tool-btn" data-tool="code" title="Code Snippet"><i data-lucide="code"></i></button>
    </div>

    <!-- Bottom Left: Undo/Clear -->
    <div class="ui-panel bottom-left">
        <div class="control-group">
            <button class="tool-btn" id="undo" title="Undo"><i data-lucide="undo"></i></button>
            <button class="tool-btn" id="clear" title="Clear"><i data-lucide="trash-2"></i></button>
        </div>
    </div>

    <!-- Bottom Right: Zoom -->
    <div class="ui-panel bottom-right">
        <div class="control-group">
            <button class="tool-btn" id="zoom-out"><i data-lucide="minus"></i></button>
            <span id="zoom-level" style="line-height:40px; padding:0 10px; min-width:60px; text-align:center">100%</span>
            <button class="tool-btn" id="zoom-in"><i data-lucide="plus"></i></button>
        </div>
    </div>

    <!-- Code Input Modal -->
    <div id="code-modal" class="modal">
        <div class="modal-box">
            <h3>Insert Code</h3>
            <textarea id="code-text" placeholder="Paste code here..."></textarea>
            <div style="display:flex; gap:10px; justify-content: flex-end;">
                <button id="code-cancel" style="background:transparent; color:#fff; border:none; cursor:pointer">Cancel</button>
                <button id="code-save" style="background:var(--accent); border:none; padding:5px 15px; border-radius:5px; cursor:pointer">Insert</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
    <script>lucide.createIcons();</script>
</body>
</html>
